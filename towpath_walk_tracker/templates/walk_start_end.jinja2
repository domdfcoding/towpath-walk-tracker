{# djlint:off #}
{% macro script(this, kwargs) %}
    // var {{this.get_name()}} = L.popup();

    function latLngPop(e) {
        if (!sidebar_add_walk_pane.classList.contains("active")) {
            return;
        }

        let closest_latlng = snapCoordToLine(e.latlng.lat, e.latlng.lng);
        addMarker(closest_latlng.lat, closest_latlng.lng);

        if (placedMarkerCount == 2) createWalk();

    }

    sidebar.on('closing', function(e) {
        if (sidebar_add_walk_pane.classList.contains("active")) clearMarkers();
    });

    {{this._parent.get_name()}}.on('click', latLngPop);
{% endmacro %}
{# djlint:on #}
